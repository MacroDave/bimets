library(bimets)

#define model
OzModDefinition=
  "MODEL
COMMENT> Test Oz Macro Model in R bimets package

COMMENT> Consumption
BEHAVIORAL> rc
TSRANGE 1990 3 2019 4
EQ> TSDELTALOG(rc,1) = a1+a2*(LOG(TSLAG(rc,1))-LOG(TSLAG(gdp,1))) + a3*TSDELTALOG(gdp,1) + a4*TSLAG(TSDELTALOG(rc,1),1)
COEFF> a1 a2 a3 a4

COMMENT> Business Investment
BEHAVIORAL> ib
TSRANGE 1990 3 2019 4
EQ> TSDELTALOG(ib,1) = a1+a2*(LOG(TSLAG(ib,1))-LOG(TSLAG(gdp,1))) + a3*TSDELTALOG(gdp,1) + a4*TSLAG(TSDELTALOG(ib,1),1)
COEFF> a1 a2 a3 a4

COMMENT> Govt
BEHAVIORAL> g
TSRANGE 1990 3 2019 4
EQ> TSDELTALOG(g,1) = c1*TSDELTALOG(rc,1) + c2*TSLAG(TSDELTALOG(g,1),1)
COEFF> c1 c2
RESTRICT>c1=0.3
RESTRICT>c1+c2=1

COMMENT> Gross Domestic Product
IDENTITY> gdp
EQ> gdp = rc + ib + g

END"

#define model data
OzModData=list(
  gdp=TIMESERIES( 169275 , 169691 , 168823 , 167412 , 168177 , 167269 , 170694 , 169688 , 169523 , 170912 , 173053 , 174520 , 173731 , 174602 , 174060 , 177202 , 177976 , 180612 , 185695 , 186998 , 187592 , 189345 , 192190 , 192593 , 195985 , 198455 , 196693 , 198632 , 203275 , 204700 , 208058 , 212070 , 208439 , 212756 , 218640 , 222391 , 224083 , 225114 , 229614 , 232459 , 229955 , 234427 , 236449 , 235573 , 236761 , 239346 , 240460 , 243846 , 246372 , 251039 , 253739 , 257976 , 259472 , 259939 , 264661 , 271942 , 275429 , 278524 , 281212 , 286924 , 286702 , 293961 , 296489 , 300236 , 302576 , 306658 , 310548 , 313530 , 319925 , 325523 , 328735 , 334292 , 337893 , 340702 , 342555 , 342336 , 340641 , 343915 , 344601 , 351404 , 353420 , 356505 , 358671 , 362882 , 368882 , 371108 , 380748 , 383878 , 389426 , 394941 , 394370 , 400098 , 395188 , 389705 , 397455 , 399063 , 397320 , 395964 , 398412 , 398403 , 398746 , 400161 , 399238 , 400271 , 403894 , 406389 , 405839 , 410833 , 414667 , 419617 , 421667 , 426664 , 429656 , 431774 , 433404 , 435057 , 437523 , 441428 , 442371 , 444738,START=c(1990,1),FREQ=4), 
  
  rc=TIMESERIES( 106525 , 107107 , 107246 , 106573 , 106802 , 107244 , 108514 , 108692 , 109826 , 110819 , 111037 , 111402 , 111352 , 112242 , 111995 , 113888 , 114520 , 115215 , 117410 , 118055 , 119409 , 120903 , 121222 , 122580 , 123680 , 124491 , 124795 , 125775 , 127001 , 129023 , 130843 , 132617 , 133022 , 135186 , 137955 , 139347 , 141939 , 142898 , 144537 , 146519 , 146914 , 148104 , 149550 , 150480 , 151830 , 152852 , 153372 , 154603 , 156519 , 158952 , 161033 , 161613 , 162411 , 163523 , 165659 , 169334 , 172623 , 173646 , 175807 , 178066 , 177552 , 180800 , 181605 , 182163 , 184333 , 187245 , 189377 , 192047 , 196076 , 197860 , 201256 , 203699 , 204624 , 203899 , 203396 , 203262 , 204150 , 207308 , 208199 , 210648 , 211495 , 214390 , 216416 , 218918 , 220578 , 222485 , 223909 , 224649 , 227549 , 228404 , 229014 , 229375 , 230746 , 231379 , 233720 , 235126 , 236490 , 237626 , 239395 , 240679 , 241772 , 243243 , 245601 , 246796 , 249060 , 250061 , 251270 , 252962 , 254025 , 255895 , 257910 , 260315 , 261655 , 263704 , 264600 , 265467 , 266585 , 267483 , 267839 , 269010,START=c(1990,1),FREQ=4), 
  
  ib=TIMESERIES( 15308 , 14549 , 14385 , 13547 , 13009 , 12494 , 12166 , 11858 , 12198 , 12029 , 11988 , 13455 , 13172 , 13071 , 13157 , 13485 , 13828 , 14860 , 15874 , 16537 , 16494 , 17205 , 17396 , 17490 , 18994 , 19538 , 19421 , 19493 , 20371 , 20918 , 21138 , 21722 , 23074 , 22238 , 22340 , 23287 , 22797 , 23407 , 24365 , 24540 , 24360 , 25054 , 25737 , 23547 , 23945 , 24048 , 24407 , 25222 , 26241 , 27193 , 27845 , 30338 , 30257 , 30505 , 32153 , 33500 , 33752 , 34356 , 34745 , 37240 , 37131 , 39117 , 40942 , 42947 , 42992 , 43426 , 43355 , 43913 , 46919 , 48521 , 49485 , 49883 , 51695 , 53097 , 54275 , 54188 , 52003 , 51957 , 49297 , 51427 , 49289 , 50457 , 50939 , 52315 , 55617 , 57449 , 64166 , 63877 , 69140 , 71292 , 71905 , 73188 , 69922 , 68933 , 69785 , 68208 , 67021 , 66472 , 65174 , 64231 , 62435 , 60769 , 57705 , 56366 , 55022 , 53903 , 51783 , 52940 , 54592 , 54860 , 56830 , 56805 , 57318 , 57201 , 56159 , 56328 , 56673 , 56902 , 56276 , 56147,START=c(1990,1),FREQ=4), 
  
  g=TIMESERIES( 47442 , 48035 , 47192 , 47292 , 48366 , 47531 , 50014 , 49138 , 47499 , 48064 , 50028 , 49663 , 49207 , 49289 , 48908 , 49829 , 49628 , 50537 , 52411 , 52406 , 51689 , 51237 , 53572 , 52523 , 53311 , 54426 , 52477 , 53364 , 55903 , 54759 , 56077 , 57731 , 52343 , 55332 , 58345 , 59757 , 59347 , 58809 , 60712 , 61400 , 58681 , 61269 , 61162 , 61546 , 60986 , 62446 , 62681 , 64021 , 63612 , 64894 , 64861 , 66025 , 66804 , 65911 , 66849 , 69108 , 69054 , 70522 , 70660 , 71618 , 72019 , 74044 , 73942 , 75126 , 75251 , 75987 , 77816 , 77570 , 76930 , 79142 , 77994 , 80710 , 81574 , 83706 , 84884 , 84886 , 84488 , 84650 , 87105 , 89329 , 92636 , 91658 , 91316 , 91649 , 92687 , 91174 , 92673 , 95352 , 92737 , 95245 , 93451 , 97535 , 94520 , 89393 , 93950 , 95729 , 93809 , 91866 , 93843 , 93493 , 94539 , 96149 , 95932 , 97109 , 99812 , 102425 , 102786 , 104931 , 106050 , 108862 , 106927 , 109544 , 110683 , 110869 , 112645 , 113262 , 114265 , 117043 , 118256 , 119581,START=c(1990,1),FREQ=4)
)

#load model and model data
OzMod=LOAD_MODEL(modelText=OzModDefinition)
OzMod=LOAD_MODEL_DATA(OzMod,OzModData)
#estimate model
OzMod=ESTIMATE(OzMod)

#simulate model
OzMod=SIMULATE(OzMod
                 ,TSRANGE=c(1991,1,2019,4)
                 ,simConvergence=0.00001
                 ,simIterLimit=100
)

#get simulated time series "consumption" and "gdp*"
TABIT(OzMod$simulation$rc)

#RESCHECK SIMULATION
#simulate model
OzMod=SIMULATE(OzMod
                 ,simType='RESCHECK'
                 ,TSRANGE=c(1991,1,2019,1)
                 ,simConvergence=0.00001
                 ,simIterLimit=100
)

TABIT(((OzMod$simulation$rc-OzMod$modelData$rc)/OzMod$modelData$rc)*100)




